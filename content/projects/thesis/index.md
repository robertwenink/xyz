---
title: "Thesis project"
subtitle: ""
date: 2023-09-18T15:52:50+02:00
lastmod: 2023-09-18T15:52:50+02:00
draft: false
description: ""

tags: [CFD, Gaussian Process Regression, GPR, Kriging, surrogate modelling]
categories: [Surrogate modelling]

featuredImage: ""
featuredImagePreview: ""

bibFile: "library-bib.json" 
# citations, see : https://github.com/loup-brun/hugo-cite
---
In June of 2023, I defended my thesis project to obtain both a master's degree in Marine Engineering and Computer Science, awarded a 8.5 in both disciplines. The complete thesis titled "Multi-Fidelity Kriging Extrapolation" can be found on the [TU Delft repository](https://repository.tudelft.nl/islandora/object/uuid%3Ad30374fd-8213-40c7-bd72-f17b108d7759?collection=education). In this article, I highlight some parts of this thesis that are of general interest.
 
Kriging, more known outside engineering as Gaussian Process Regression, is at the core of the work of this thesis and should therefore be understood to some extent. Kriging is described [here](./posts/kriging/).
<!--more-->

# Motivation
Automatic design procedures based on Computational Fluid Dynamics (CFD) simulations are becoming increasingly important in practical ship design {{< cite "Scholcz2015" >}}. For an efficient optimisation phase of such a design procedure, accurate high-dimensional surrogate modelling is essential {{< cite "Viana2014" >}}. A surrogate model provides a cheap substitute for an expensive (CFD) simulation, enabling us to feasibly approximate and explore the design space. To illustrate the effectiveness and promise of using surrogate models in naval optimisation routines, {{< cite "Scholcz2017-" >}} show that Surrogate-Based Global optimisation (SBGO) of a tanker`s hull reduces the required computational time from two weeks to only a day when compared with a direct optimisation algorithm. This is important since {{< cite "Raven2017-" >}} state that the time available for hull shape optimisation with the goal of, for instance, wave resistance minimisation is usually only 1 to 2 weeks or even less.

<!-- % Considerably, Multi-Fidelity SGBO still suffers from the \emph{curse of dimensionality} {{< cite "Palar2019" >}} just like its single-fidelity counterpart does, even though the multi-fidelity approach provides improvements. -->
However, SGBO suffers from the *curse of dimensionality* {{< cite "Palar2019" >}}. Here, the curse of dimensionality refers to the exponential growth of the design-space volume when the number of dimensions or design variables increases, thereby drastically increasing the amount of (expensive) simulations required to cover this volume and reliably construct the surrogate model. In other words, if we increase the number of design variables we optimise over, we drastically need to increase the number of CFD simulations, which is costly or even infeasible. Simultaneously, high-dimensional design spaces naturally arise in naval ship design {{< cite "Scholcz2017" >}}, making this curse of dimensionality a limiting problem for using SBGO in practice. 

Multi-fidelity modelling can improve the efficiency of SBGO, by using the usual expensive and precise data together with cheap but less accurate data. Results as early as that of {{< cite "Leifsson2013-" >}} show that optimised hull designs can be obtained at over 94\% lower computational cost when using multi-fidelity optimisation as compared to a direct high-fidelity optimisation algorithm. However, these results typically do not scale to more design variables.

We want to lessen the effects of the curse of dimensionality even further and enable ourselves to feasibly solve more complex problems of higher dimensionality, or to solve problems more cheaply and more accurately in general. {{< cite "Shan2010-" >}} survey strategies of solving high-dimensional expensive black-box problems. These strategies include problem decomposition, screening (e.g. Global Sensitivity Analysis), mapping (e.g. lossless projection of high-dimensional spaces onto lower-dimensional spaces; or multi-fidelity approaches that map a lower-fidelity onto a higher-fidelity model such as considered in this thesis), and (adaptive) space reduction.
From these, {{< cite "Shan2010-" >}} mark mapping as a promising approach and note that research does not take advantage of the characteristics of the underlying expensive functions. {{< cite "Wu2020-" >}} reiterate this conclusion, demonstrating that this research direction still holds relevance today.

In this work, we recognise that the *grid convergence* property of CFD solvers is currently an unused source of information that could further improve the performance of the surrogate model and the corresponding optimisation process. Grid convergence states that the simulation solution converges to the true simulation solution as the grid is refined. CFD simulations reported by for instance {{< cite "Eijk2021wedge-" >}} show the clear presence of grid convergence. Therefore, this thesis explores a novel hierarchical multi-fidelity mapping method exploiting this grid convergence information to relieve the effects of the curse of dimensionality at the expensive high fidelity. 

# Method background
{{< cite "Jones2001-" >}} discusses the relation of Kriging with respect to other surrogate modelling methods and explores possible improvements to EGO and the Expected Improvement criterion. As one of the most promising directions for further work, he hinted towards multi-fidelity simulation: using expensive high-precision simulations together with simulations of a lower precision but a much lower cost. This enables us to respectively balance exploitation and exploration of the search space and thereby cut costs while improving the quality of the surrogate.

Since then, Multi-Fidelity Kriging has received significant research effort, see for instance the review papers of {{< cite "Viana2014;Godino2016;Peherstorfer2018-" >}}. {{< cite "Kennedy2000-" >}} mathematically formulated the fundamentals, while {{< cite "Forrester2007-" >}} provides a more transparent overview. {{< cite "Gratiet2014-" >}} show that the model of {{< cite "Kennedy2000-" >}} can be equivalently but more cheaply formulated as recursively nested independent Kriging problems, one for each fidelity level. {{< cite "Perdikaris2017-" >}} improve upon this work by generalising the linear autoregressive\footnote{Meaning that the relations between fidelity levels and the regression parameters are directly solved in the linear system} formulation of {{< cite "Gratiet2014-" >}} to better accommodate non-linear-relations. 
<!-- % The latest and only {{< cite "Wang2023" >}} further methodological improvement on this work is given by {{< cite "Perdikaris2017-" >}} who generalise the linear autoregressive\footnote{Meaning that the relations between fidelity levels and the regression parameters are directly solved in the linear system} formulation of {{< cite "Gratiet2014-" >}} to better accommodate non-linear-relations.  -->

In this thesis, we focus on the linear auto-regressive formulation of {{< cite "Gratiet2014-" >}}\footnote{Why the method of {{< cite "Perdikaris2017-" >}} is not used and the method of {{< cite "Gratiet2014-" >}} is the only multi-fidelity Kriging surrogate used as a reference is discussed in-depth in \cref{discussion:onlyGratiet}.} in the optimisation context of the EGO adaptive sampling algorithm, and are interested in the potential of this combination to reduce the costs of SBGO. {{< cite "Meliani2019;Korondi2021-" >}} use the recursive formulation of {{< cite "Gratiet2014-" >}} to introduce a multi-fidelity approach to the EGO algorithm and formulate level-selection criteria that balance the expected reduction of the prediction variance with the costs of sampling a given level. The multi-fidelity SBGO method of {{< cite "Meliani2019-" >}} will act as a reference to the method proposed in this thesis since both methods use a so-called nested Design of Experiments (DoE), a sampling strategy that provides the most complete information on the relation between the fidelities {{< cite "Kennedy2000" >}}.
 <!-- % We do not use the method of {{< cite "Perdikaris2017-" >}} because the method of {{< cite "Gratiet2014-" >}} still is the most popular method {{< cite "Wang2023" >}} while having a ready-to-use implementation available {{< cite "SMT2019" >}}. -->

Notably, optimisation methods based on Multi-Fidelity Kriging hold promise in maritime engineering. {{< cite "Raven2018;Raven2019-" >}} apply Multi-Fidelity Kriging in a ship hull form optimisation with a dense set of potential flow results and a coarse set of RANS data, and positively compared the result with the single-fidelity formulation. {{< cite "Leifsson2013-" >}} shows that optimised hull designs can be obtained at over 94\% lower computational cost when compared to a direct high-fidelity optimisation algorithm, even though they used the outdated multiplicative discrepancy model instead of a comprehensive discrepancy {{< cite "Godino2016" >}}. 
{{< cite "Korondi2019-" >}} performs reliability-based optimisation of a ducted propeller using an EGO-like strategy and a multi-fidelity Kriging surrogate. Although performed under compressible flow conditions, the same techniques are interesting to incompressible flows. {{< cite "Liu2022-" >}} uses viscous and potential flow calculations as the high- and low-fidelity respectively and shows the multi-fidelity Kriging approach can obtain a more optimal hydrodynamic hull form than the single-fidelity model alone. 

Although these are promising results, Multi-Fidelity Kriging still seems relatively rarely applied within maritime engineering, presumably because the increased complexity of the experimental setup is not plenty offset by the possible benefits. There are still unresolved issues regarding when it is advantageous to use a multi-fidelity over the standard single-fidelity approach {{< cite "Toal2015;Godino2019;Korondi2021" >}} in terms of accuracy, cost, and assumed data characteristics. This work aims to increase the applicability of multi-fidelity surrogate modelling and SBGO in maritime engineering by providing clearer usage conditions while increasing the benefits of using these methodologies. Additionally, it is expected that the process of selecting the fidelities is simpler since the assumption of grid convergence as introduced in the [motivation](#motivation) implies restricting the scope of this process to a single CFD solver with simulations at different resolutions. 


# Bibliography
{{< bibliography cited >}}
